
<!DOCTYPE HTML>
<html>
 <head>
   

<link type="text/css" href="/site_static/css/booki.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
<script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
<script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
<script type="text/javascript" src="/site_static/js/booki.js"></script>
<script src="/site_static/js/messaging.js" type="text/javascript"></script>   
<script type="text/javascript" src="/site_static/js/general.js"></script>
<link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
<link type="text/css" href="/site_static/css/jquery-ui_overrides.css" rel="Stylesheet" >
<script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

<link rel="SHORTCUT ICON" href="http://write.flossmanuals.net/site_static/images/favicon.ico" type="image/x-icon">
<meta property="og:site_name" content="FLOSS Manuals"/><meta name="description" content="Free Manuals for Freedom"/>

<script type="text/javascript">
  $(function() {
      $.booki.sputnikDispatcherURL = "/_sputnik/";

      $("#dialog-sputnik-error").dialog({
          modal: true,
          autoOpen: false,
          buttons: {
            Ok: function() {
               $(this).dialog('close');
               window.location = '.';
            }
          }
      });
  
      $("FORM.messagefield").messagefield('init', {'view_post': '/messaging/post' });  
  });
</script>


   
<title>/chapter: Sed / COMMAND LINE</title>
<link type="text/css" href="/site_static/css/published.css" rel="Stylesheet" />

<link rel="alternate" type="application/rss+xml" title="RSS feed for COMMAND LINE" href="/feeds/rss/book/command-line/" /> 
<link rel="alternate" type="application/atom+xml" title="Atom feed for COMMAND LINE" href="/feeds/atom/book/command-line/" /> 

<link rel="alternate" type="application/rss+xml" title="RSS feed for chapter SED" href="/feeds/rss/chapter/command-line/command-line/" /> 
<link rel="alternate" type="application/atom+xml" title="Atom feed for chapter SED" href="/feeds/atom/chapter/command-line/command-line/" /> 


<style>
SPAN.bookicommentmarker {
  background-color: white;
}

SPAN.bookicommentmarker > IMG.markerimage { 
   display: none;
}


</style>



   <link type="text/css" href="/static/css/_user.css" rel="Stylesheet" >
 </head>
<body>

<div class="topbar"> 
  <div class="logotext"><a href="http://write.flossmanuals.net/">FLOSS Manuals</a> </div>

  <div class="meta-bar">
    
    <ul>
      <li>
        <a href="/accounts/signin/?redirect=/command-line/sed/">Sign In / Create Account</a>
      </li>
    </ul>
    
    <div style="padding-top: 10px; padding-right: 15px;">
      <br/>
      

<script>
  $(function() {
    var $frm = $("FORM[name=changelang]");
	
    $("A[href=#]", $frm).click(function() {
        var lang = $(this).attr("class").substr(4);
	
        $("INPUT[name=language]", $frm).val(lang);
        $frm.submit();
	
        return false;
    });
  });
 </script>

<form name="changelang" method="POST" action="/accounts/i18n/setlang/?language=en-us">
  <input type="hidden" name="language" value="en-us">
  
    &nbsp;English&nbsp;|
  
  
  
    &nbsp;<a class="langes" href="#">Español</a>&nbsp;|
  

  
    &nbsp;<a class="langfr" href="#">Français</a>&nbsp;|
  
	
  
    &nbsp;<a class="langit" href="#">Italiano</a>&nbsp;|
  
	
  
    &nbsp;<a class="langpt" href="#">Português</a>&nbsp;|
  
	
  
    &nbsp;<a class="langru" href="#">Русский</a>&nbsp;|
  
	
  
    &nbsp;<a class="langsq" href="#">Shqip</a>
  	
</form>

    </div>
    
    
  </div><!-- End of .meta-bar -->
</div><!-- End top bar -->

<div class="menubar shadow">
  
  
  <div class="navbox">
    <ul>
      <li><a href="/list-books/">Books</a></li>
      <li><a href="/list-groups/">Groups</a></li>
      <li><a href="/list-people/">People</a></li>
    </ul>      
  </div><!-- End of .navbox -->       
</div>

<div class="content-container">
  <div class="content shadow">
    <!-- Content box and the drop shadow-->
    
   <h2>COMMAND LINE</h2>

<div class="padded">
<div id="bookmenu">
<ul>

 
   <li><b>INTRODUCTION</b></li>
 

 
   <li><a href="/command-line/introduction/">INTRODUCTION</a></li>
 

 
   <li><a href="/command-line/about-this-manual/">ABOUT THIS  MANUAL</a></li>
 

 
   <li><b>BASICS</b></li>
 

 
   <li><a href="/command-line/getting-started/">GETTING STARTED</a></li>
 

 
   <li><a href="/command-line/beginning-syntax/">BEGINNING SYNTAX</a></li>
 

 
   <li><a href="/command-line/moving-around/">MOVING AROUND</a></li>
 

 
   <li><b>COMMANDS</b></li>
 

 
   <li><a href="/command-line/basic-commands/">BASIC COMMANDS</a></li>
 

 
   <li><a href="/command-line/standard-files/">STANDARD FILES</a></li>
 

 
   <li><a href="/command-line/cut-down-on-typing/">CUT DOWN ON TYPING</a></li>
 

 
   <li><a href="/command-line/superusers/">SUPERUSERS</a></li>
 

 
   <li><a href="/command-line/redirection/">REDIRECTION</a></li>
 

 
   <li><b>ADVANCED-ISH</b></li>
 

 
   <li><a href="/command-line/multiple-files/">MULTIPLE FILES</a></li>
 

 
   <li><a href="/command-line/searching-for-files/">SEARCHING FOR FILES</a></li>
 

 
   <li><a href="/command-line/piping/">PIPING</a></li>
 

 
   <li><a href="/command-line/processes/">PROCESSES</a></li>
 

 
   <li><a href="/command-line/file-structure/">FILE STRUCTURE</a></li>
 

 
   <li><a href="/command-line/command-history/">COMMAND HISTORY</a></li>
 

 
   <li><b>ADVANCED</b></li>
 

 
   <li><a href="/command-line/permissions/">PERMISSIONS</a></li>
 

 
   <li><a href="/command-line/interactive-editing/">INTERACTIVE EDITING</a></li>
 

 
   <li><a href="/command-line/checking-exit/">CHECKING EXIT</a></li>
 

 
   <li><a href="/command-line/sub-commands/">SUB COMMANDS</a></li>
 

 
   <li><a href="/command-line/moving-again/">MOVING AGAIN</a></li>
 

 
   <li><a href="/command-line/customisation/">CUSTOMISATION</a></li>
 

 
   <li><a href="/command-line/parameter-substitution/">PARAMETER SUBSTITUTION</a></li>
 

 
   <li><a href="/command-line/gnuscreen/">GNUSCREEN</a></li>
 

 
   <li><a href="/command-line/ssh/">SSH</a></li>
 

 
   <li><a href="/command-line/installing-software/">INSTALLING SOFTWARE</a></li>
 

 
   <li><a href="/command-line/making-your-own-interpreter/">MAKING YOUR OWN INTERPRETER</a></li>
 

 
   <li><b>TEXT EDITORS</b></li>
 

 
   <li><a href="/command-line/text-editors/">TEXT EDITORS</a></li>
 

 
   <li><a href="/command-line/nano/">NANO</a></li>
 

 
   <li><a href="/command-line/vim/">VIM</a></li>
 

 
   <li><a href="/command-line/emacs/">EMACS</a></li>
 

 
   <li><a href="/command-line/kedit/">KEDIT</a></li>
 

 
   <li><a href="/command-line/gedit/">GEDIT</a></li>
 

 
   <li><b>SCRIPTING</b></li>
 

 
   <li><a href="/command-line/scripting/">SCRIPTING</a></li>
 

 
   <li><a href="/command-line/maintaining-scripts/">MAINTAINING SCRIPTS</a></li>
 

 
   <li><a href="/command-line/other-languages/">OTHER LANGUAGES</a></li>
 

 
   <li><a href="/command-line/sed/">SED</a></li>
 

 
   <li><a href="/command-line/awk/">AWK</a></li>
 

 
   <li><a href="/command-line/regular-expressions/">REGULAR EXPRESSIONS</a></li>
 

 
   <li><b>SCRIPTING LANGUAGES</b></li>
 

 
   <li><a href="/command-line/perl/">PERL</a></li>
 

 
   <li><a href="/command-line/python/">PYTHON</a></li>
 

 
   <li><a href="/command-line/ruby/">RUBY</a></li>
 

 
   <li><a href="/command-line/gnu-octave/">GNU OCTAVE</a></li>
 

 
   <li><b>APPENDICES</b></li>
 

 
   <li><a href="/command-line/glossary/">GLOSSARY</a></li>
 

 
   <li><a href="/command-line/command-quickie/">COMMAND QUICKIE</a></li>
 

 
   <li><a href="/command-line/outline/">OUTLINE</a></li>
 

 
   <li><a href="/command-line/credits/">CREDITS</a></li>
 

</ul>
</div>
<div id="bookcontent">
   
<html dir="LTR"><head><title>CommandLineIntro: SED</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body>
<h1>The Sed Text Processor
</h1>
<p>Sed (stream editor) is a utility that does transformations on a line-by-line basis. The commands you give it are run on each line of input in turn. It is useful both for processing files and in a pipe to process output from other programs, such as here:
</p>
<pre>$<strong> wc -c * | sort -n | sed ...</strong>
</pre>
<h2>Basic Syntax and Substitution
</h2>
<p>A common use of Sed is to change words within a file. You may have used "Find and Replace" in GUI based editors. Sed can do this much more powerfully and faster:
</p>
<pre> $ <strong>sed "s/foo/bar/g" inputfile &gt; outputfile</strong></pre>
<p> Let's break down this simple command. First we tell the shell to run <code>sed</code>. The processing we want to do is enclosed in double quotation marks; we'll come back to that in a moment. We then tell Sed the name of the <em>inputfile</em> and use standard shell redirection (&gt;) to the name of our <em>outputfile</em>. You can specify multiple input files if you want; Sed processes them in order and creates a single stream of output from them.
  <br></p>
<p>The expression looks complex but is very simple once you learn to take it apart. The initial "s" means "substitute". This is followed by the text you want to find and the replacement text, with slashes (/) as separators. Thus, here we want to find "foo" in the inputfile and put "bar" in its places. Only the output file is affected; Sed never changes its input files.
</p>
<p>Finally, the trailing "g" stands for "global", meaning to do this for the whole line. If you leave off the "g" and "foo" appears twice on the same line, only the first "foo" is changed to "bar".
</p>
<pre>$ <strong>cat testfile</strong>
this has foo then bar then foo then bar
this has bar then foo then bar then foo
$ <strong>sed "s/foo/bar/g" testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
this has bar then bar then bar then bar
this has bar then bar then bar then bar
</pre>
<p> Now let's try that again without the <code>/g</code> on the command and see what happens.
  <br></p>
<pre>$ <strong>cat testfile</strong>
this has foo then bar then foo then bar
this has bar then foo then bar then foo
$ <strong>sed "s/foo/bar/" testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
this has bar then bar then foo then bar
this has bar then bar then bar then foo</pre>
<p> Notice that without the "g", Sed performed the substitution only the first time it finds a match on each line.
</p>
<p>This is all well and good, but what if you wanted to change the second occurrence of the word foo in our testfile? To specify a particular occurrence to change, just specify the number after the substitute commands.
</p>
<pre>$ <strong>sed "s/foo/bar/2" inputfile &gt; outputfile </strong></pre>
<p> You can also combine this with the <code>g</code> flag (in some versions of Sed) to leave the first occurrence alone and change from the 2nd occurrence to the end of the line.
</p>
<pre>$<strong> sed "s/foo/bar/2g" inputfile &gt; outputfile</strong></pre>
<h2>Sed Expressions Explained
</h2>
<p>Sed understands regular expressions, to which a chapter is devoted in this book. Here are some of the special characters you can use to match what you wish to substitute.
</p>
<pre><strong>$</strong> matches the end of a line
<strong>^</strong> matches the start of a line
<strong>*</strong> matches zero or more occurrences of the previous character
<strong>[ ]</strong> any characters within the brackets will be matched
</pre>
<p>For example, you could change any instance of the words "cat", "can", and "car" to "dog" by using the following:
</p>
<pre> $ <strong>sed "s/ca[tnr]/dog/g" inputfile &gt; outputfile</strong></pre>
<p>In the next example, the first [0-9] ensures that at least one digit must be present to be matched. The second [0-9] may be missing or may be present any number of times, because it is followed by the * metacharacter. Finally, the digits are removed because there is nothing between the second and third slashes where you can put your replacement text.
</p>
<pre> $ <strong>sed "s/[0-9][0-9]*//g" inputfile &gt; outputfile</strong></pre>Inside an expression, if the first character is a caret (^), Sed matches only if the text is at the start of the line.
<br><pre>$<strong> echo dogs cats and dogs | sed "s/^dogs/doggy/"</strong>
doggy cats and dogs</pre>
<p>A dollar sign at the end of a pattern expression tells Sed to match the text only if it is at the end of the line.
</p>
<pre>$ <strong>echo dogs cats and cats | sed "s/cats$/kitty/"</strong>
dogs cats and kitty</pre>
<p>A line changes only if the matching string is where you require it to be; if the same text occurs elsewhere in the sentence it is not be modified.
</p>
<h2>Deletion
</h2>
<p>The "d" command deletes an entire line that contains a matching pattern. Unlike the "s" (substitute) command, the "d" goes after the pattern.
  <br></p>
<pre>$ <strong>cat testfile</strong>
line with a cat
line with a dog
line with another cat
$ <strong>sed "/cat/d" testfile &gt; newtestfile</strong>
$ <strong>cat newtestfile</strong>
line with a dog</pre>
<p>The regular expression ^$ means "match a line that has nothing between the beginning and the end", in other words, a blank line. So you can remove all blank lines using the "d" command with that regular expression:
</p>
<pre>$ <strong>sed "/^$/d" inputfile &gt; outputfile</strong></pre>
<h2>Controlling Printing
</h2>
<p>Suppose you want to print certain lines and suppress the rest. That is, instead of specifying which lines to delete using "d", you want specify which lines to keep.
</p>
<p> This can be done with two features:
</p>
<p>Specify the <code>-n</code> option, which means "do not print lines by default".
</p>
<p>End the pattern with "p" to print the line matched by the pattern.
</p>
<p>We'll show this with a file that contains names:
  <br></p>
<pre>$ <strong>cat testfile</strong>
Mr. Jones
Mrs. Jones
Mrs. Lee                                                                        Mr. Lee
</pre>
<p>We've decided to standardize on "Ms" for women, so we want to change "Mrs." to "Ms". The pattern is:
</p>
<pre> s/Mrs\./Ms/
</pre>
<p> and to print only the lines we changed, enter:
  <br></p>
<pre>$ <strong>sed -n "s/Mrs\./Ms/p" testfile</strong></pre>
<h2>Multiple Patterns
</h2>
<p>Sed can be passed more than one operation at a time. We can do this by specifying each pattern after an <code>-e</code> option.
</p>
<pre>$ <strong>echo Gnus eat grass | sed -e "s/Gnus/Penguins/" -e "s/grass/fish/"</strong>
Penguins eat fish.</pre>
<h2>Controlling Edits With Patterns
</h2>
<p>We can also be more specific about which lines a pattern gets applied to.  By supplying a pattern before the operation, you restrict the operation to lines that have that pattern.
</p>
<pre>$ <strong>cat testfile</strong>
one: number
two: number
three: number
four: number
one: number
three: number
two: number
$ <strong>sed "/one/ s/number/1/" testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
one 1
two: number
three: number
four: number
one: 1
three: number
two: number</pre>
<p>The <code>sed</code> command in that example had two patterns. The first pattern, "one", simply controls which lines Sed changes. The second pattern replaces "number" with "1" on those lines.
</p>
<p> This works with multiple patterns as well.
  <br></p>
<pre>$ <strong>cat testfile</strong>
one: number
two: number
three: number
four: number
one: number
three: number
two: number
$ <strong>sed -e "/one/ s/number/1/" -e "/two/ s/number/2/" \</strong>
<strong>      -e "/three/ s/number/3/" -e "/four/ s/number/4/" \</strong>
<strong>      &lt; testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
one: 1
two: 2
three: 3
four: 4
one: 1
three: 3
two: 2</pre>
<h2>Controlling Edits With Line Numbers
</h2>
<p>Instead of specifying patterns that can operate on any line, we can specify an exact line or range of lines to edit.
</p>
<pre>$ <strong>cat testfile</strong>
even number
odd number
odd number
even number
$ <strong>sed "2,3 s/number/1/" &lt; testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
even number
odd 1
odd 1
even number</pre>
<p>The comma acts as the range separator, telling Sed to work only on lines two through three.
</p>
<pre>$<strong> cat testfile</strong>
even number
odd number
odd number
$ <strong>sed -e "2,3 s/number/1/" -e "1 s/number/2/" &lt; testfile &gt; testchangedfile</strong>
$ <strong>cat testchangedfile</strong>
even 2
odd 1
odd 1</pre>
<p>Sometimes you might not know exactly how long a file is, but you want to go from a specified line to the end of the file. You could use <code>wc</code> or the like and count the total lines, but you can also use a dollar sign ($) to represent the last line:
</p>
<pre>$ <strong>sed "25,$ s/number/1/" &lt; testfile &gt; testchangedfile</strong></pre>
<p>The $ in an address range is Sed's way of specifying, "all the way to the end of the file".
</p>
<h2>Scripting SED commands
</h2>
<p>By using the <code>-f</code> argument to the <code>sed</code> command, you can feed Sed a list of commands to run. For example, if you put the following patterns in a file called <em>sedcommands</em>:
  <br></p>
<pre>s/foo/bar/g
s/dog/cat/g
s/tree/house/g
s/little/big/g
</pre>
<p> You can use this on a single file by entering the following:
</p>
<pre>$ <strong>sed -f sedcommands &lt; inputfile &gt; outputfile</strong></pre>
<p>Note that each command in the file must be on a separate line.
  <br></p>
<p>There is much more to Sed than can be written in this chapter. In fact, whole books have been written about Sed, and there are many excellent tutorials about Sed online.
</p>
</body></html>
   

</div>
</div>

  </div>
</div>
<!-- End of content -->



<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
<div id="dialog-sputnik-error" title="Can't communicate with booktype">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    There has been error in communication with Booktype server.
    Not sure right now where is the problem.
  </p>
  <p>
    You should refresh this page.
  </p>
</div>


<ul class="strings template">
 <li class="ok">OK</li>
 <li class="back">Back</li>
 <li class="create">Create</li>
 <li class="cancel">Cancel</li>
 <li class="next">Next</li>
 <li class="import">Import</li>
 <li class="savechanges">Save changes</li>
 <li class="errorcreategroup">Couldn't create a group!</li>
 <li class="msgepub">enter epub URL</li>
 <li class="msgarchive">enter Archive.org ID</li>
 <li class="msgwiki">enter Wikibooks URL</li>
 <li class="msgbooktype">enter Booktype URL</li>
 <li class="deletebook">Delete book</li>
</ul>

</body>
</html>

