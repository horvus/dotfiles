
<!DOCTYPE HTML>
<html>
 <head>
   

<link type="text/css" href="/site_static/css/booki.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
<script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
<script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
<script type="text/javascript" src="/site_static/js/booki.js"></script>
<script src="/site_static/js/messaging.js" type="text/javascript"></script>   
<script type="text/javascript" src="/site_static/js/general.js"></script>
<link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
<link type="text/css" href="/site_static/css/jquery-ui_overrides.css" rel="Stylesheet" >
<script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

<link rel="SHORTCUT ICON" href="http://write.flossmanuals.net/site_static/images/favicon.ico" type="image/x-icon">
<meta property="og:site_name" content="FLOSS Manuals"/><meta name="description" content="Free Manuals for Freedom"/>

<script type="text/javascript">
  $(function() {
      $.booki.sputnikDispatcherURL = "/_sputnik/";

      $("#dialog-sputnik-error").dialog({
          modal: true,
          autoOpen: false,
          buttons: {
            Ok: function() {
               $(this).dialog('close');
               window.location = '.';
            }
          }
      });
  
      $("FORM.messagefield").messagefield('init', {'view_post': '/messaging/post' });  
  });
</script>


   
 <title>/chapter: E-Waveshaping / CSOUND Español</title>
 <link type="text/css" href="/site_static/css/draft.css" rel="Stylesheet" />

 <link rel="alternate" type="application/rss+xml" title="RSS feed for CSOUND Español" href="/feeds/rss/book/csound-espanol/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for CSOUND Español" href="/feeds/atom/book/csound-espanol/" /> 

 <link rel="alternate" type="application/rss+xml" title="RSS feed for chapter E. WAVESHAPING" href="/feeds/rss/chapter/csound-espanol/csound-espanol/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for chapter E. WAVESHAPING" href="/feeds/atom/chapter/csound-espanol/csound-espanol/" /> 
 
 <script type="text/javascript" src="/site_static/js/draft.js"></script>


   <link type="text/css" href="/static/css/_user.css" rel="Stylesheet" >
 </head>
<body>

<div class="topbar"> 
  <div class="logotext"><a href="http://write.flossmanuals.net/">FLOSS Manuals</a> </div>

  <div class="meta-bar">
    
    <ul>
      <li>
        <a href="/accounts/signin/?redirect=/csound-espanol/_draft/_v/1.0/e-waveshaping/">Sign In / Create Account</a>
      </li>
    </ul>
    
    <div style="padding-top: 10px; padding-right: 15px;">
      <br/>
      

<script>
  $(function() {
    var $frm = $("FORM[name=changelang]");
	
    $("A[href=#]", $frm).click(function() {
        var lang = $(this).attr("class").substr(4);
	
        $("INPUT[name=language]", $frm).val(lang);
        $frm.submit();
	
        return false;
    });
  });
 </script>

<form name="changelang" method="POST" action="/accounts/i18n/setlang/?language=en-us">
  <input type="hidden" name="language" value="en-us">
  
    &nbsp;English&nbsp;|
  
  
  
    &nbsp;<a class="langes" href="#">Español</a>&nbsp;|
  

  
    &nbsp;<a class="langfr" href="#">Français</a>&nbsp;|
  
	
  
    &nbsp;<a class="langit" href="#">Italiano</a>&nbsp;|
  
	
  
    &nbsp;<a class="langpt" href="#">Português</a>&nbsp;|
  
	
  
    &nbsp;<a class="langru" href="#">Русский</a>&nbsp;|
  
	
  
    &nbsp;<a class="langsq" href="#">Shqip</a>
  	
</form>

    </div>
    
    
  </div><!-- End of .meta-bar -->
</div><!-- End top bar -->

<div class="menubar shadow">
  
  
  <div class="navbox">
    <ul>
      <li><a href="/list-books/">Books</a></li>
      <li><a href="/list-groups/">Groups</a></li>
      <li><a href="/list-people/">People</a></li>
    </ul>      
  </div><!-- End of .navbox -->       
</div>

<div class="content-container">
  <div class="content shadow">
    <!-- Content box and the drop shadow-->
    

<h2>CSOUND Español</h2>
<div class="padded">
 <div id="bookmenu" style="background: url(/site_static/images/draft_bg.png) repeat !important;"> 
  <ul>
   
    
      <li><b>INTRODUCCIÓN</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/preface/">PREFACIO</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/how-to-use-this-manual/">CÓMO USAR ESTE MANUAL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/on-this-release/">ACERCA DE ESTE LANZAMIENTO</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/credits/">CRÉDITOS</a></li>
    
   
    
      <li><b>01 CUESTIONES BÁSICAS</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-digital-audio/">A. AUDIO DIGITAL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-pitch-and-frequency/">B. ALTURA Y FRECUENCIA</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-intensities/">C. INTENSIDADES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-random/">D. ALEATORIEDAD</a></li>
    
   
    
      <li><b>02 INICIO RÁPIDO</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-make-csound-run/">A. CORRIENDO CSOUND</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-csound-syntax/">B. SINTÁXIS DE CSOUND</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-configuring-midi/">C. CONFIGURACIÓN MIDI</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-live-audio/">D. AUDIO EN VIVO</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-rendering-to-file/">E. SALIDA A UN ARCHIVO</a></li>
    
   
    
      <li><b>03 EL LENGUAJE DE CSOUND</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-initialization-and-performance-pass/">A. PASADAS DE INICIALIZACIÓN Y EJECUCIÓN</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-local-and-global-variables/">B. LOCAL AND GLOBAL VARIABLES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-control-structures/">C. CONTROL STRUCTURES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-function-tables/">D. FUNCTION TABLES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-arrays/">E. ARRAYS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/f-live-events/">F. LIVE EVENTS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/g-user-defined-opcodes/">G. USER DEFINED OPCODES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/h-macros/">H. MACROS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/i-functional-syntax/">I. FUNCTIONAL SYNTAX</a></li>
    
   
    
      <li><b>04 SOUND SYNTHESIS</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-additive-synthesis/">A. ADDITIVE SYNTHESIS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-subtractive-synthesis/">B. SUBTRACTIVE SYNTHESIS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-amplitude-and-ring-modulation/">C. AMPLITUDE AND RING MODULATION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-frequency-modulation/">D. FREQUENCY MODULATION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-waveshaping/">E. WAVESHAPING</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/f-granular-synthesis/">F. GRANULAR SYNTHESIS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/g-physical-modelling/">G. PHYSICAL MODELLING</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/h-scanned-synthesis/">H. SCANNED SYNTHESIS</a></li>
    
   
    
      <li><b>05 SOUND MODIFICATION</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-envelopes/">A. ENVELOPES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-panning-and-spatialization/">B. PANNING AND SPATIALIZATION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-filters/">C. FILTERS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-delay-and-feedback/">D. DELAY AND FEEDBACK</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-reverberation/">E. REVERBERATION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/f-am-rm-waveshaping/">F. AM / RM / WAVESHAPING</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/g-granular-synthesis/">G. GRANULAR SYNTHESIS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/h-convolution/">H. CONVOLUTION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/i-fourier-analysis-spectral-processing/">I. FOURIER ANALYSIS / SPECTRAL PROCESSING</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/k-ats-resynthesis/">K. ATS RESYNTHESIS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/l-amplitude-and-pitch-tracking/">L. AMPLITUDE AND PITCH TRACKING</a></li>
    
   
    
      <li><b>06 SAMPLES</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-record-and-play-soundfiles/">A. RECORD AND PLAY SOUNDFILES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-record-and-play-buffers/">B. RECORD AND PLAY BUFFERS</a></li>
    
   
    
      <li><b>07 MIDI</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-receiving-events-by-midiin/">A. RECEIVING EVENTS BY MIDIIN</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-triggering-instrument-instances/">B. TRIGGERING INSTRUMENT INSTANCES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-working-with-controllers/">C. WORKING WITH CONTROLLERS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-reading-midi-files/">D. READING MIDI FILES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-midi-output/">E. MIDI OUTPUT</a></li>
    
   
    
      <li><b>08 OTHER COMMUNICATION</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-open-sound-control/">A. OPEN SOUND CONTROL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-csound-and-arduino/">B. CSOUND AND ARDUINO</a></li>
    
   
    
      <li><b>09 CSOUND IN OTHER APPLICATIONS</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-csound-in-pd/">A. CSOUND IN PD</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-csound-in-maxmsp/">B. CSOUND IN MAXMSP</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-csound-in-ableton-live/">C. CSOUND IN ABLETON LIVE</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-csound-as-a-vst-plugin/">D. CSOUND AS A VST PLUGIN</a></li>
    
   
    
      <li><b>10 CSOUND FRONTENDS</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/csoundqt/">CSOUNDQT</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/cabbage/">CABBAGE</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/blue/">BLUE</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/winxound/">WINXOUND</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/csound-via-terminal/">CSOUND VIA TERMINAL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/web-based-csound/">WEB BASED CSOUND</a></li>
    
   
    
      <li><b>11 CSOUND UTILITIES</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/csound-utilities/">CSOUND UTILITIES</a></li>
    
   
    
      <li><b>12 CSOUND AND OTHER PROGRAMMING LANGUAGES</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/a-the-csound-api/">A. THE CSOUND API</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/b-python-inside-csound/">B. PYTHON INSIDE CSOUND</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/c-python-in-csoundqt/">C. PYTHON IN CSOUNDQT</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/d-lua-in-csound/">D. LUA IN CSOUND</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/e-csound-in-ios/">E. CSOUND IN iOS</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/f-csound-on-android/">F. CSOUND ON ANDROID</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/g-csound-and-haskell/">G. CSOUND AND HASKELL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/h-csound-and-html/">H. CSOUND AND HTML</a></li>
    
   
    
      <li><b>13 EXTENDING CSOUND</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/extending-csound/">EXTENDING CSOUND</a></li>
    
   
    
      <li><b>OPCODE GUIDE</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/overview/">OVERVIEW</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/signal-processing-i/">SIGNAL PROCESSING I</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/signal-processing-ii/">SIGNAL PROCESSING II</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/data/">DATA</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/realtime-interaction/">REALTIME INTERACTION</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/instrument-control/">INSTRUMENT CONTROL</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/maths-pythonsystem-plugins/">MATHS, PYTHON/SYSTEM, PLUGINS</a></li>
    
   
    
      <li><b>APPENDIX</b></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/methods-of-writing-csound-scores/">METHODS OF WRITING CSOUND SCORES</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/glossary/">GLOSSARY</a></li>
    
   
    
      <li><a href="/csound-espanol/_draft/_v/1.0/links/">LINKS</a></li>
    
   
  </ul>
 </div>
 <div id="bookcontent"   style="background: url(/site_static/images/draft_bg.png) repeat !important;">
   

  <p>Csound: WAVESHAPING</p>
<p>WAVESHAPING</p>
<p>WAVESHAPING</p>
<p>Waveshaping is in some ways a relation of modulation techniques such as frequency or phase modulation. Waveshaping can create quite dramatic sound transformations through the application of a very simple process. In FM (frequency modulation) modulation synthesis occurs between two oscillators, waveshaping is implemented using a single oscillator (usually a simple sine oscillator) and a so-called 'transfer function'. The transfer function transforms and shapes the incoming amplitude values using a simple look-up process: if the incoming value is x, the outgoing value becomes y. This can be written as a table with two columns. Here is a simple example:</p>
<p>Waveshaping es de alguna manera una relaci&oacute;n de t&eacute;cnicas de modulaci&oacute;n como la frecuencia o la modulaci&oacute;n de fase. Waveshaping puede crear transformaciones de sonido bastante dram&aacute;ticas a trav&eacute;s de la aplicaci&oacute;n de un proceso muy simple. En FM (modulaci&oacute;n de frecuencia), la s&iacute;ntesis de modulaci&oacute;n se produce entre dos osciladores, el modelado de onda se implementa usando un solo oscilador (normalmente un simple oscilador senoidal) y una llamada funci&oacute;n de transferencia. La funci&oacute;n de transferencia transforma y da forma a los valores de amplitud entrantes usando un simple proceso de b&uacute;squeda: si el valor entrante es x, el valor saliente se convierte en y. Esto se puede escribir como una tabla con dos columnas. Aqu&iacute; hay un ejemplo sencillo:</p>
<p>&nbsp;</p>
<table style="width: 332px; border: 1px dotted #000000; border-collapse: collapse; height: 113px;" cellpadding="5">
<tbody>
<tr>
<td style="border: 1px dotted #000000;">&nbsp; <strong>Incoming (x) Value</strong></td>
<td style="border: 1px dotted #000000;">&nbsp;<strong> Outgoing (y) Value</strong></td>
</tr>
<tr>
<td style="border: 1px dotted #000000;">-0.5 or lower</td>
<td style="border: 1px dotted #000000;">&nbsp;-1</td>
</tr>
<tr>
<td style="border: 1px dotted #000000;">&nbsp;between -0.5 and 0.5</td>
<td style="border: 1px dotted #000000;">&nbsp;remain unchanged</td>
</tr>
<tr>
<td style="border: 1px dotted #000000;">&nbsp;0.5 or higher</td>
<td style="border: 1px dotted #000000;">&nbsp;1</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Illustrating this in an x/y coordinate system results in the following graph:</p>
<p><img src="static/04Ebild1a.png" alt="" width="499" height="500" /><br />&nbsp;</p>
<p>Basic Implementation Model</p>
<p>Modelo b&aacute;sico de implementaci&oacute;n</p>
<p>Although Csound contains several opcodes for waveshaping, implementing waveshaping from first principles as Csound code is fairly straightforward. The x-axis is the amplitude of every single sample, which is in the range of -1 to +1. This number has to be used as index to a table which stores the transfer function. To create a table like the one above, you can use Csound's sub-routine GEN07. This statement will create a table of 4096 points with the desired shape:</p>
<p>Aunque Csound contiene varios opcodes para wavehaping, la implementaci&oacute;n wavehaping de los primeros principios como Csound c&oacute;digo es bastante sencillo. El eje x es la amplitud de cada muestra, que est&aacute; en el rango de -1 a 1. Este n&uacute;mero tiene que ser utilizado como &iacute;ndice de una tabla que almacena la funci&oacute;n de transferencia. Para crear una tabla como la anterior, puede utilizar la sub-rutina Csounds GEN07. Esta declaraci&oacute;n crear&aacute; una tabla de 4096 puntos con la forma deseada:</p>
<p>giTrnsFnc ftgen 0, 0, 4096, -7, -0.5, 1024, -0.5, 2048, 0.5, 1024, 0.5</p>
<p><img style="width: 598px; height: 345px;" src="static/04E01ftable2.png" alt="" />&nbsp;</p>
<p>Now two problems must be solved. First, the index of the function table is not -1 to +1. Rather, it is either 0 to 4095 in the raw index mode, or 0 to 1 in the normalized mode. The simplest solution is to use the normalized index and scale the incoming amplitudes, so that an amplitude of -1 becomes an index of 0, and an amplitude of 1 becomes an index of 1:</p>
<p>Ahora hay que resolver dos problemas. En primer lugar, el &iacute;ndice de la tabla de funciones no es -1 a 1. En cambio, es 0 a 4095 en el modo de &iacute;ndice en bruto, o 0 a 1 en el modo normalizado. La soluci&oacute;n m&aacute;s simple es usar el &iacute;ndice normalizado y escalar las amplitudes entrantes, de modo que una amplitud de -1 se convierta en un &iacute;ndice de 0, y una amplitud de 1 se convierte en un &iacute;ndice de 1:</p>
<p>aIndx = (aAmp + 1) / 2</p>
<p>The other problem stems from the difference in the accuracy of possible values in a sample and in a function table. Every single sample is encoded in a 32-bit floating point number in standard audio applications - or even in a 64-bit float in recent Csound. A table with 4096 points results in a 12-bit number, so you will have a serious loss of accuracy (= sound quality) if you use the table values directly. Here, the solution is to use an interpolating table reader. The opcode tablei (instead of table) does this job. This opcode then needs an extra point in the table for interpolating, so we give 4097 as the table size instead of 4096.</p>
<p>El otro problema se deriva de la diferencia en la exactitud de los valores posibles en una muestra y en una tabla de funciones. Cada muestra individual se codifica en un n&uacute;mero de punto flotante de 32 bits en aplicaciones de audio est&aacute;ndar o incluso en un flotador de 64 bits en Csound reciente. Una tabla con 4096 puntos resulta en un n&uacute;mero de 12 bits, por lo que tendr&aacute; una p&eacute;rdida grave de precisi&oacute;n (= calidad de sonido) si utiliza los valores de tabla directamente. Aqu&iacute;, la soluci&oacute;n es usar un lector de tabla de interpolaci&oacute;n. El opcode tablei (en lugar de la tabla) hace este trabajo. Este opcode necesita un punto extra en la tabla para la interpolaci&oacute;n, por lo que le damos 4097 como el tama&ntilde;o de la tabla en lugar de 4096.</p>
<p>&nbsp;</p>
<p>This is the code for simple waveshaping using our transfer function which has been discussed previously:</p>
<p>Este es el c&oacute;digo para wavehaping simple utilizando nuestra funci&oacute;n de transferencia que se ha discutido anteriormente:</p>
<p>&nbsp;</p>
<p><em><strong>EXAMPLE 04E01_Simple_waveshaping.csd</strong></em></p>
<pre>&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt;
-odac
&lt;/CsOptions&gt;
&lt;CsInstruments&gt;
sr = 44100
ksmps = 32
nchnls = 2
0dbfs = 1

giTrnsFnc ftgen 0, 0, 4097, -7, -0.5, 1024, -0.5, 2048, 0.5, 1024, 0.5
giSine    ftgen 0, 0, 1024, 10, 1

instr 1
aAmp      poscil    1, 400, giSine
aIndx     =         (aAmp + 1) / 2
aWavShp   tablei    aIndx, giTrnsFnc, 1
          outs      aWavShp, aWavShp
endin

&lt;/CsInstruments&gt;
&lt;CsScore&gt;
i 1 0 10
&lt;/CsScore&gt;
&lt;/CsoundSynthesizer&gt;
</pre>
<p><img src="static/04E01audacity.png" alt="" width="599" height="336" />&nbsp;</p>
<p>Powershape</p>
<p>Forma de poder</p>
<p>The powershape opcode performs waveshaping by simply raising all samples to the power of a user given exponent. Its main innovation is that the polarity of samples within the negative domain will be retained. It simply performs the power function on absolute values (negative values made positive) and then reinstates the minus sign if required. It also normalises the input signal between -1 and 1 before shaping and then rescales the output by the inverse of whatever multiple was required to normalise the input. This ensures useful results but does require that the user states the maximum amplitude value expected in the opcode declaration and thereafter abide by that limit. The exponent, which the opcode refers to as 'shape amount', can be varied at k-rate thereby facilitating the creation of dynamic spectra upon a constant spectrum input.</p>
<p>El opcode de powershape realiza wavehaping levantando simplemente todas las muestras a la energ&iacute;a de un exponente dado usuario. Su principal innovaci&oacute;n es que se mantendr&aacute; la polaridad de muestras dentro del dominio negativo. Simplemente realiza la funci&oacute;n de potencia en valores absolutos (valores negativos hechos positivos) y luego reinstala el signo menos si es necesario. Tambi&eacute;n normaliza la se&ntilde;al de entrada entre -1 y 1 antes de dar forma y luego vuelve a escalar la salida por la inversa de cualquier m&uacute;ltiplo que se requiri&oacute; para normalizar la entrada. Esto asegura resultados &uacute;tiles, pero requiere que el usuario indique el valor m&aacute;ximo de amplitud esperado en la declaraci&oacute;n del c&oacute;digo operativo y, posteriormente, respete ese l&iacute;mite. El exponente, al que el opcode se refiere como cantidad de forma, se puede variar a velocidad k facilitando de este modo la creaci&oacute;n de espectros din&aacute;micos a una entrada de espectro constante.</p>
<p>If we consider the simplest possible input - a sine wave - a shape amount of '1' will produce no change (raising any value to the power of 1 leaves that value unchanged).</p>
<p>Si consideramos la entrada m&aacute;s simple posible - una onda senoidal - una cantidad de forma de 1 no producir&aacute; ning&uacute;n cambio (elevar cualquier valor a la potencia de 1 deja ese valor sin cambios).</p>
<p><img src="static/Powershape1.png" alt="" /></p>
<p>A shaping amount of 2.5 will visibly 'squeeze' the waveform as values less than 1 become increasingly biased towards the zero axis.</p>
<p>Una cantidad de conformaci&oacute;n de 2,5 comprime visiblemente la forma de onda cuando valores inferiores a 1 se tornan cada vez m&aacute;s inclinados hacia el eje cero.</p>
<p><img src="static/Powershape2_5.png" alt="" />&nbsp;</p>
<p>&nbsp;</p>
<p>Much higher values will narrow the positive and negative peaks further. Below is the waveform resulting from a shaping amount of 50.</p>
<p>Valores mucho m&aacute;s altos reducir&aacute;n a&uacute;n m&aacute;s los picos positivos y negativos. A continuaci&oacute;n se muestra la forma de onda resultante de una cantidad de conformaci&oacute;n de 50.</p>
<p><img src="static/Powershape50.png" alt="" /></p>
<p>&nbsp;</p>
<p>Shape amounts less than 1 (but greater than zero) will give the opposite effect of drawing values closer to -1 or 1. The waveform resulting from a shaping amount of 0.5 shown below is noticeably more rounded than the sine wave input.</p>
<p>Las cantidades de forma inferiores a 1 (pero superiores a cero) dar&aacute;n el efecto opuesto de aproximar valores de dibujo a -1 o 1. La forma de onda resultante de una cantidad de conformaci&oacute;n de 0,5 mostrada a continuaci&oacute;n es notablemente m&aacute;s redondeada que la entrada de onda sinusoidal.</p>
<p><img src="static/Powershape0_5.png" alt="" /></p>
<p>&nbsp;</p>
<p>Reducing shape amount even closer to zero will start to show squaring of the waveform. The result of a shape amount of 0.1 is shown below.</p>
<p>Reducci&oacute;n de la cantidad de forma a&uacute;n m&aacute;s cerca de cero comenzar&aacute; a mostrar cuadratura de la forma de onda. A continuaci&oacute;n se muestra el resultado de una cantidad de forma de 0,1.</p>
<p><img src="static/Powershape0_1.png" alt="" /></p>
<p>&nbsp;</p>
<p class="western">The sonograms of the five examples shown above are as shown below:</p>
<p class="western">Los sonogramas de los cinco ejemplos mostrados anteriormente son como se muestra a continuaci&oacute;n:</p>
<p><img src="static/Sonograms2.PNG" alt="" /></p>
<p>As power (shape amount) is increased from 1 through 2.5 to 50, it can be observed how harmonic partials are added. It is worth noting also that when the power exponent is 50 the strength of the fundamental has waned somewhat. What is not clear from the sonogram is that the partials present are only the odd numbered ones. As the power exponent is reduced below 1 through 0.5 and finally 0.1, odd numbered harmonic partials again appear but this time the strength of the fundamental remains constant. It can also be observed that aliasing is becoming a problem as evidenced by the vertical artifacts in the sonograms for 0.5 and in particular 0.1. This is a significant concern when using waveshaping techniques. Raising the sampling rate can provide additional headroom before aliasing manifests but ultimately subtlety in waveshaping's use is paramount.</p>
<p>A medida que la potencia (cantidad de forma) aumenta de 1 a 2.5 a 50, se puede observar c&oacute;mo se a&ntilde;aden los parciales arm&oacute;nicos. Vale la pena se&ntilde;alar tambi&eacute;n que cuando el exponente de potencia es 50 la fuerza de la fundamental ha disminuido algo. Lo que no est&aacute; claro en el sonograma es que los parciales presentes son s&oacute;lo los impares. A medida que el exponente de potencia se reduce por debajo de 1 a 0,5 y finalmente por 0,1, parciales de arm&oacute;nicos impares aparecen nuevamente, pero esta vez la fuerza del fundamental permanece constante. Tambi&eacute;n se puede observar que el aliasing se est&aacute; convirtiendo en un problema como se evidencia por los artefactos verticales en los sonogramas para 0,5 y en particular 0,1. Esto es una preocupaci&oacute;n importante cuando se utilizan t&eacute;cnicas de ondas. Aumentar la velocidad de muestreo puede proporcionar espacio libre adicional antes de que se manifiesten los alias, pero en &uacute;ltima instancia la sutileza en el uso de ondas es primordial.</p>
<p>&nbsp;</p>
<p>Distort</p>
<p>The distort opcode, authored by Csound's original creator Barry Vercoe, was originally part of the Extended Csound project but was introduced into Canonical Csound in version 5. It waveshapes an input signal according to a transfer function provided by the user using a function table. At first glance this may seem to offer little more than what we have already demonstrated from first principles, but it offers a number of additional features that enhance its usability. The input signal first has soft-knee compression applied before being mapped through the transfer function. Input gain is also provided via the 'distortion amount' input argument and this provides dynamic control of the waveshaping transformation. The result of using compression means that spectrally the results are better behaved than is typical with waveshaping. A common transfer function would be the hyperbolic tangent (tanh) function. Csound now possesses an GEN routine GENtanh for the creation of tanh functions:</p>
<p>El opcode distorsionado, creado por el creador original de Csounds, Barry Vercoe, fue originalmente parte del proyecto Extended Csound, pero fue introducido en Csound can&oacute;nico en la versi&oacute;n 5. Se wavehapes una se&ntilde;al de entrada de acuerdo con una funci&oacute;n de transferencia proporcionada por el usuario utilizando una tabla de funciones. A primera vista esto puede parecer poco m&aacute;s de lo que ya hemos demostrado de los primeros principios, pero ofrece una serie de caracter&iacute;sticas adicionales que mejoran su usabilidad. La se&ntilde;al de entrada primero tiene compresi&oacute;n de rodilla suave aplicada antes de ser mapeada a trav&eacute;s de la funci&oacute;n de transferencia. La ganancia de entrada tambi&eacute;n se proporciona a trav&eacute;s del argumento de entrada de la cantidad de distorsi&oacute;n y esto proporciona control din&aacute;mico de la transformaci&oacute;n wavehaping. El resultado del uso de la compresi&oacute;n significa que espectralmente los resultados se comportan mejor de lo que es t&iacute;pico con wavehaping. Una funci&oacute;n de transferencia com&uacute;n ser&iacute;a la funci&oacute;n tangente hiperb&oacute;lica (tanh). Csound ahora posee una rutina de GEN GENtanh para la creaci&oacute;n de funciones de tanh:</p>
<p>GENtanh</p>
<pre class="western">f # time size "tanh" start end rescale</pre>
<p>By adjusting the 'start' and 'end' values we can modify the shape of the tanh transfer function and therefore the aggressiveness of the waveshaping ('start' and 'end' values should be the same absolute values and negative and positive respectively if we want the function to pass through the origin from the lower left quadrant to the upper right quadrant).</p>
<p>Ajustando los valores de inicio y de fin podemos modificar la forma de la funci&oacute;n de transferencia de tanh y por lo tanto la agresividad de la forma de onda (los valores de inicio y final deben ser los mismos valores absolutos y negativos y positivos respectivamente si queremos que la funci&oacute;n pase a trav&eacute;s del origen Desde el cuadrante inferior izquierdo hasta el cuadrante superior derecho).</p>
<p>Start and end values of -1 and 1 will produce a gentle 's' curve.</p>
<p>Los valores de inicio y fin de -1 y 1 producir&aacute;n una suave curva.</p>
<p><img src="static/tanh-1to1.png" alt="" /></p>
<p>&nbsp;</p>
<p>This represents only a very slight deviation from a straight line function from (-1,-1) to (1,1) - which would produce no distortion - therefore the effects of the above used as a transfer function will be extremely subtle.</p>
<p>Esto representa s&oacute;lo una desviaci&oacute;n muy ligera de una funci&oacute;n de l&iacute;nea recta de (-1, -1) a (1,1) - lo que no producir&iacute;a distorsi&oacute;n - por lo tanto los efectos de lo anterior utilizado como una funci&oacute;n de transferencia ser&aacute; extremadamente sutil.</p>
<p>Start and end points of -5 and 5 will produce a much more dramatic curve and more dramatic waveshaping:</p>
<p>Los puntos inicial y final de -5 y 5 producir&aacute;n una curva mucho m&aacute;s dram&aacute;tica y m&aacute;s dram&aacute;tica wavehaping:</p>
<p>f 1 0 1024 "tanh" -5 5 0</p>
<p>&nbsp;<img src="static/tanh-5to5.png" alt="" /></p>
<p>Note that the GEN routine's argument p7 for rescaling is set to zero ensuring that the function only ever extends from -1 and 1. The values provided for 'start' and 'end' only alter the shape.</p>
<p>Tenga en cuenta que el argumento de rutinas GEN p7 para reescalar se establece en cero asegur&aacute;ndose de que la funci&oacute;n s&oacute;lo se extiende desde -1 y 1. Los valores proporcionados para el inicio y el final s&oacute;lo alteran la forma.</p>
<p>In the following test example a sine wave at 200 hz is waveshaped using distort and the tanh function shown above.</p>
<p>En el ejemplo de prueba siguiente, una onda sinusoidal a 200 hz se forma en ondas utilizando la distorsi&oacute;n y la funci&oacute;n tanh mostrada anteriormente.</p>
<p>&nbsp;</p>
<p><em><strong>EXAMPLE 04E02_Distort_1.csd</strong></em>&nbsp;</p>
<pre>&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt;&nbsp;&nbsp;
-dm0 -odac
&lt;/CsOptions&gt;

&lt;CsInstruments&gt;

sr = 44100
ksmps =32
nchnls = 1
0dbfs = 1

giSine&nbsp; ftgen&nbsp;&nbsp; 1,0,1025,10,1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; sine function
giTanh&nbsp; ftgen&nbsp;&nbsp; 2,0,257,"tanh",-10,10,0 ; tanh function

instr 1
 aSig&nbsp; poscil&nbsp;&nbsp; 1, 200, giSine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; a sine wave
 kAmt&nbsp; line&nbsp;&nbsp;&nbsp;&nbsp; 0, p3, 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; rising distortion amount
 aDst&nbsp; distort&nbsp; aSig, kAmt, giTanh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; distort the sine tone
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aDst*0.1
endin

&lt;/CsInstruments&gt;
&lt;CsScore&gt;
i 1 0 4
&lt;/CsScore&gt;
&lt;/CsoundSynthesizer&gt;</pre>
<p>The resulting sonogram looks like this:</p>
<p><img src="static/DistortExample1.png" alt="" /></p>
<p>&nbsp;</p>
<p>As the distort amount is raised from zero to 1 it can be seen from the sonogram how upper partials emerge and gain in strength. Only the odd numbered partials are produced, therefore over the fundemental at 200 hz partials are present at 600, 1000, 1400 hz and so on. If we want to restore the even numbered partials we can simultaneously waveshape a sine at 400 hz, one octave above the fundamental as in the next example:</p>
<p>A medida que la cantidad de distorsi&oacute;n se eleva de cero a 1, puede verse en el sonograma c&oacute;mo emergen los parciales superiores y aumentan su fuerza. S&oacute;lo se producen los parciales impares, por lo tanto sobre el fundemental a 200 hz los parciales est&aacute;n presentes en 600, 1000, 1400 hz y as&iacute; sucesivamente. Si queremos restaurar los parciales pares pares podemos simult&aacute;neamente modelar un seno a 400 hz, una octava por encima de la fundamental como en el siguiente ejemplo:</p>
<p><em><strong>EXAMPLE 04E03_Distort_2.csd</strong></em></p>
<pre>&lt;CsoundSynthesizer&gt;
&lt;CsOptions&gt;
-dm0 -odac
&lt;/CsOptions&gt;
&lt;CsInstruments&gt;

sr = 44100
ksmps =32
nchnls = 1
0dbfs =&nbsp;&nbsp; &nbsp;1

giSine&nbsp;&nbsp; &nbsp;ftgen&nbsp;&nbsp; &nbsp;1,0,1025,10,1
giTanh&nbsp;&nbsp; &nbsp;ftgen&nbsp;&nbsp; 2,0,257,"tanh",-10,10,0

instr 1
 kAmt&nbsp; line&nbsp;&nbsp;&nbsp;&nbsp; 0, p3, 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; rising distortion amount
 aSig&nbsp; poscil&nbsp;&nbsp; 1, 200, giSine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; a sine
 aSig2 poscil&nbsp;&nbsp; kAmt*0.8,400,giSine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; a sine an octave above
 aDst&nbsp; distort&nbsp; aSig+aSig2, kAmt, giTanh ; distort a mixture of the two sines
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aDst*0.1
endin

&lt;/CsInstruments&gt;

&lt;CsScore&gt;
i 1 0 4
&lt;/CsScore&gt;
&lt;/CsoundSynthesizer&gt;</pre>
<p>The higher of the two sines is faded in using the distortion amount control so that when distortion amount if zero we will be left with only the fundamental. The sonogram looks like this:</p>
<p>El mayor de los dos senos se desvaneci&oacute; en el uso del control de la cantidad de distorsi&oacute;n de modo que cuando la cantidad de distorsi&oacute;n si cero nos quedar&aacute; con s&oacute;lo el fundamental. El sonograma se ve as&iacute;:</p>
<p><img src="static/DistortExample2.png" alt="" /></p>
<p>What we hear this time is something close to a sawtooth waveform with a rising low-pass filter. The higher of the two input sines at 400 hz will produce overtones at 1200, 2000, 2800... thereby filling in the missing partials.</p>
<p>Lo que o&iacute;mos esta vez es algo cercano a una forma de onda de diente de sierra con un filtro de paso bajo ascendente. El m&aacute;s alto de los dos senos de entrada a 400 hz producir&aacute; arm&oacute;nicos a 1200, 2000, 2800 ... rellenando as&iacute; los parciales que faltan.</p>
<p>REFERENCES</p>
<p>Distortion Synthesis - a tutorial with Csound examples by Victor Lazzarini<a href="http://www.csounds.com/journal/issue11/distortionSynthesis.html"><del> </del>http://www.csounds.com/journal/issue11/distortionSynthesis.html</a></p>
   
  </div>
 </div>


  </div>
</div>
<!-- End of content -->



<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
<div id="dialog-sputnik-error" title="Can't communicate with booktype">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    There has been error in communication with Booktype server.
    Not sure right now where is the problem.
  </p>
  <p>
    You should refresh this page.
  </p>
</div>


<ul class="strings template">
 <li class="ok">OK</li>
 <li class="back">Back</li>
 <li class="create">Create</li>
 <li class="cancel">Cancel</li>
 <li class="next">Next</li>
 <li class="import">Import</li>
 <li class="savechanges">Save changes</li>
 <li class="errorcreategroup">Couldn't create a group!</li>
 <li class="msgepub">enter epub URL</li>
 <li class="msgarchive">enter Archive.org ID</li>
 <li class="msgwiki">enter Wikibooks URL</li>
 <li class="msgbooktype">enter Booktype URL</li>
 <li class="deletebook">Delete book</li>
</ul>

</body>
</html>

