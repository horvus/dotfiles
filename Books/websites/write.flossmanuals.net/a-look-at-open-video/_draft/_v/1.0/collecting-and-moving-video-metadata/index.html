
<!DOCTYPE HTML>
<html>
 <head>
   

<link type="text/css" href="/site_static/css/booki.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
<script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
<script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
<script type="text/javascript" src="/site_static/js/booki.js"></script>
<script src="/site_static/js/messaging.js" type="text/javascript"></script>   
<script type="text/javascript" src="/site_static/js/general.js"></script>
<link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
<link type="text/css" href="/site_static/css/jquery-ui_overrides.css" rel="Stylesheet" >
<script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

<link rel="SHORTCUT ICON" href="http://write.flossmanuals.net/site_static/images/favicon.ico" type="image/x-icon">
<meta property="og:site_name" content="FLOSS Manuals"/><meta name="description" content="Free Manuals for Freedom"/>

<script type="text/javascript">
  $(function() {
      $.booki.sputnikDispatcherURL = "/_sputnik/";

      $("#dialog-sputnik-error").dialog({
          modal: true,
          autoOpen: false,
          buttons: {
            Ok: function() {
               $(this).dialog('close');
               window.location = '.';
            }
          }
      });
  
      $("FORM.messagefield").messagefield('init', {'view_post': '/messaging/post' });  
  });
</script>


   
 <title>/chapter: Collecting-And-Moving-Video-Metadata / A Look at Open Video</title>
 <link type="text/css" href="/site_static/css/draft.css" rel="Stylesheet" />

 <link rel="alternate" type="application/rss+xml" title="RSS feed for A Look at Open Video" href="/feeds/rss/book/a-look-at-open-video/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for A Look at Open Video" href="/feeds/atom/book/a-look-at-open-video/" /> 

 <link rel="alternate" type="application/rss+xml" title="RSS feed for chapter Collecting and Moving Video Metadata" href="/feeds/rss/chapter/a-look-at-open-video/a-look-at-open-video/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for chapter Collecting and Moving Video Metadata" href="/feeds/atom/chapter/a-look-at-open-video/a-look-at-open-video/" /> 
 
 <script type="text/javascript" src="/site_static/js/draft.js"></script>


   <link type="text/css" href="/static/css/_user.css" rel="Stylesheet" >
 </head>
<body>

<div class="topbar"> 
  <div class="logotext"><a href="http://write.flossmanuals.net/">FLOSS Manuals</a> </div>

  <div class="meta-bar">
    
    <ul>
      <li>
        <a href="/accounts/signin/?redirect=/a-look-at-open-video/_draft/_v/1.0/collecting-and-moving-video-metadata/">Sign In / Create Account</a>
      </li>
    </ul>
    
    <div style="padding-top: 10px; padding-right: 15px;">
      <br/>
      

<script>
  $(function() {
    var $frm = $("FORM[name=changelang]");
	
    $("A[href=#]", $frm).click(function() {
        var lang = $(this).attr("class").substr(4);
	
        $("INPUT[name=language]", $frm).val(lang);
        $frm.submit();
	
        return false;
    });
  });
 </script>

<form name="changelang" method="POST" action="/accounts/i18n/setlang/?language=en-us">
  <input type="hidden" name="language" value="en-us">
  
    &nbsp;English&nbsp;|
  
  
  
    &nbsp;<a class="langes" href="#">Español</a>&nbsp;|
  

  
    &nbsp;<a class="langfr" href="#">Français</a>&nbsp;|
  
	
  
    &nbsp;<a class="langit" href="#">Italiano</a>&nbsp;|
  
	
  
    &nbsp;<a class="langpt" href="#">Português</a>&nbsp;|
  
	
  
    &nbsp;<a class="langru" href="#">Русский</a>&nbsp;|
  
	
  
    &nbsp;<a class="langsq" href="#">Shqip</a>
  	
</form>

    </div>
    
    
  </div><!-- End of .meta-bar -->
</div><!-- End top bar -->

<div class="menubar shadow">
  
  
  <div class="navbox">
    <ul>
      <li><a href="/list-books/">Books</a></li>
      <li><a href="/list-groups/">Groups</a></li>
      <li><a href="/list-people/">People</a></li>
    </ul>      
  </div><!-- End of .navbox -->       
</div>

<div class="content-container">
  <div class="content shadow">
    <!-- Content box and the drop shadow-->
    

<h2>A Look at Open Video</h2>
<div class="padded">
 <div id="bookmenu" style="background: url(/site_static/images/draft_bg.png) repeat !important;"> 
  <ul>
   
    
      <li><b>Part One</b></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/a-look-at-open-video/">A Look at Open Video</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/what-is-open-video/">What is Open Video?</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/understanding-video-files/">Understanding Video Files</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/creating-open-subtitles/">Creating Open Subtitles</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/understanding-codecs-and-containers/">Understanding Codecs and Containers</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/tools-for-creating-open-video-files/">Tools for Creating Open Video Files</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/encoding-explained/">Encoding Explained</a></li>
    
   
    
      <li><b>Part Two</b></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/a-look-at-open-video-part-two/">A Look at Open Video - Part Two </a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/taking-video-to-the-web/">Taking Video to the Web</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/video-and-html5-markup/">Video and HTML5 Markup</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/collecting-and-moving-video-metadata/">Collecting and Moving Video Metadata</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/using-ffmpeg-and-avconfv/">Using ffmpeg and avconfv</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/what-next-for-open-video/">What Next for Open Video</a></li>
    
   
    
      <li><a href="/a-look-at-open-video/_draft/_v/1.0/course-process-credits/">Course Process &amp; Credits</a></li>
    
   
  </ul>
 </div>
 <div id="bookcontent"   style="background: url(/site_static/images/draft_bg.png) repeat !important;">
   

  <html><body><h1>Collecting and Moving Video Metadata
</h1>
<p> <img style="margin: 12px;" src="static/540px-Ccd-sensor_C-M_600.jpg" height="255" width="316" align="right">Video Metadata can move in mysterious ways. Here are some of the ways it can move and be collected.
</p>
<ul><li> as a part of the video files</li>
  <li> as external files</li>
  <li> as part of a repository system</li>
</ul><p>
  <br></p>
<ul></ul><p> <strong>Metadata in external files: </strong>As we saw in one of the introductory sections, there are a number of standard metadata fields that can be included in most video containers. And Matroska files can contain str files as subtitle streams.
  <br></p>
<p><strong>Metadata in external files: </strong>Subtitles are often included in .srt files. This is common with video containers that don't support subtitle streams or for additional supporting information about video files. Possibly most commonly seen with avi files in with torrents.
</p>
<p>
</p>
<p><strong>Metadata as part of a repository system:</strong> Rather than storting the metadata in a file it can be in a database of a content management systems.
</p>
<p>Video sharing sites
</p>
<p>Archiving sites using <a href="http://pan.do/ra">Pandora</a> like <a href="http://0xdb.org/">0xdb</a> and <a href="http://pad.ma/">pad.ma</a> collect metadata about videos, and also make it available to query based on video identifier. They aim to have a more complete and flexible approach to how text and video interact. You can find out more by watching this <a href="http://camputer.org/tmp/screencast_webm/screenCast_ffmpeg_1.webm">Screen cast for Pad.ma</a>
</p>
<h2>Moving Media Metadata 
  <br></h2>
<p>There are a great number of ways of moving the metadata from one repository to another. Sometimes it involves using the site specific API, sometimes they will make the the data available in an easily machine readable format. The most common machine formats are: MRSS and schema.org microdata.<a href="http://www.schema.org/VideoObject"> Microdata video object</a> is <a href="https://support.google.com/webmasters/bin/answer.py?hl=en&amp;answer=2413309&amp;topic=1088474&amp;ctx=topic">partly read by Google</a>.
</p>
<p>Older and more common is <a href="http://video.search.yahoo.com/mrss">MRSS</a> also <a href="https://support.google.com/webmasters/bin/answer.py?hl=en&amp;answer=162163">embedded in RDFa</a> it is most commonly part of an RSS feed. Here's a hands on example of Media RSS as a transporter mechanism for media metadata in use.
</p>
<h2>Case Study - Drupal + Feeds for MRSS
</h2>
<p> As part of the Open Video Forum, there was a presentation of the aims of the transmission.cc website. Part of the aim of that website was to act as an aggregator and searchable archive of video metadata coming in from various types of RSS, Media RSS (MRSS) feeds. MRSS adds additional useful infomation to RSS feeds about video and audio files, including filesize, bitrate, width, heigth etc.
</p>
<blockquote>
  <p> <span style="font-family: courier new,courier,monospace;">&lt;media:content
    <br>   url="http://www.foo.com/movie.mov"
    <br>   fileSize="12216320"
    <br>   type="video/quicktime"
    <br>   medium="video"
    <br>   isDefault="true"
    <br>   expression="full"
    <br>   bitrate="128"
    <br>   framerate="25"
    <br>   samplingrate="44.1"
    <br>   channels="2"
    <br>   duration="185"
    <br>   height="200"
    <br>   width="300"
    <br>   lang="en" /&gt;</span>
  </p>
</blockquote>
<p> There is more information on the Media RSS specification here - <a href="http://www.rssboard.org/media-rss">http://www.rssboard.org/media-rss</a>
</p>
<h3>Developer/installer overview for transmission aggregator
</h3>
<p> Transmission used the Drupal content management system as base to build on and extended the functionality already present in existing Drupal modules. All the code is standard Drupal and contrib with a couple of important additions.
  <br><br> The feeds are pulled with the http://drupal.org/project/feeds module. Feeds makes use of the simplepie parser to interperate the incoming feeds.  Simplepie parses MRSS out of the box but feeds doesn't know what to do with this data.
</p>
<p> To solve this you can use an extention module to read the MRSS output coming from the simplepie parser. This module is checked out as a submodule but is also now in a sandbox on drupal.org <a href="https://drupal.org/sandbox/ekes/1867408">https://drupal.org/sandbox/ekes/1867408</a>
  <br><br> In the transmission.cc site there are two content types for feeds: 'MRSS feed' and  'Video'. Posting a new 'MRSS feed' with the URL of the RSS feed adds that to the list of feeds that are pulled. Items in the feed are created as 'Video' nodes.
  <br><br> The node types, and the feeds settings to use them, and to map which parts of a feed item to which parts of the node can be set up in the Drupal interface of the feeds module.
</p>
<p> <img src="http://p2pu.org/media/uploads/images/mickfuzz/2012/12/16/metadata_1.png"></p>
<p> This screen shot shows you a 'mapping' of a feed to the content pieces of your Drupal website.
</p>
<p> To make the site itself output MRSS in the RSS feed there is another module, again included but now also in a sandbox. <a href="https://drupal.org/node/1867416">https://drupal.org/node/1867416</a>
</p>
<p> The complete transmission.cc code can be found at:
  <br><br><span style="font-family: courier new,courier,monospace;&lt;span id="></span>"&gt;  git://git.iskra.net/drupal/projects/tx
  <br><br> The repository uses <a href="http://git-scm.com/book/th/Git-Tools-Submodules%20">git submodules</a> to pull external code.
  <br> If you're on the command line to get the rest of the code you then type (in the git repository you just pulled):
  <br><br><span style="font-family: courier new,courier,monospace;">  $ git submodule init
  <br>   $ git submodule update</span>
  <br><br> If you're using your favourite gui there should be a way of getting all the submodules.
  <br>  
</p>
<h4>Replicating the transmission.cc configuration
</h4> If you want to replicate the settings for mapping the MRSS feeds, they are stored in a 'feature' [this is a way of storing settings in Drupal, the main module is<a href="http://%20http://drupal.org/project/features%20"> http://drupal.org/project/features </a>].
<p>
</p> The relevant feature for this is the one found in 'tx/modules/features/mrss_feeds'
<h4>Linking to files instead of pulling them
</h4>
<p>Transmission.cc pulls the actual files rather than linking to them. If you want to link to them or embed them externally, you can change the field mappings (see the image above) to use <code>emfield</code>. Then you need not worry about the cron and transcoding sections of the tutorial.
</p>
<p>Making thumbnails of remote files, ones you have not pulled, is much more involved than local files. So sometimes you will be missing an image if there was no thumbnail specified in the MRSS feed. Emfield will also not embed all formats or sources of video properly, so if this works will depend on your source video.
</p>
<h4>Downloading files as part of a cron job
</h4>
<p>As the transmission.cc configuration maps the files to a filefield they get downloaded. This is done as part of the queue-cron job (this is created by the https://drupal.org/project/job_scheduler which is a requirement of the feeds module.
</p>
<p><strong>Important note:</strong> if you run cron the standard way, by visiting http://site/cron.php you are making huge apache php processes. To avoid this you need at least use <a href="http://drupal.org/project/drush">Drush</a> to run <code>cron</code>; as well as <code>queue-cron</code>.
</p>
<h4>Transcoding with media_mover
</h4>
<p>Transmission.cc transcodes the downloaded video using ffmpeg into files that can be easily embedded. The settings for this should be in the git repository install file. However the version of media_mover used did not export into features.
</p>
<p>The configuration of media_mover in transmission.cc is however not the best method. Pulling big files, transcoding big files, even using Drush isn't the optimal solution. Currently the transmission.cc site struggles and occasionally gets stuck on big files.
</p>
<p>The alternative is to use an alternative queue scheduler outside Drupal (examples include: rabbitmq, beanstalk, and redis with extra scripts).
</p>
<h2>Task - Show your understanding
</h2>
<ul><li>Write a comment outlining a possible use for moving video metadata (and files) between different repositories. </li>
  <li> For extra points write a short outline of the technologies you would use to do this.
  <br></li>
</ul></body></html>
   
  </div>
 </div>


  </div>
</div>
<!-- End of content -->



<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
<div id="dialog-sputnik-error" title="Can't communicate with booktype">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    There has been error in communication with Booktype server.
    Not sure right now where is the problem.
  </p>
  <p>
    You should refresh this page.
  </p>
</div>


<ul class="strings template">
 <li class="ok">OK</li>
 <li class="back">Back</li>
 <li class="create">Create</li>
 <li class="cancel">Cancel</li>
 <li class="next">Next</li>
 <li class="import">Import</li>
 <li class="savechanges">Save changes</li>
 <li class="errorcreategroup">Couldn't create a group!</li>
 <li class="msgepub">enter epub URL</li>
 <li class="msgarchive">enter Archive.org ID</li>
 <li class="msgwiki">enter Wikibooks URL</li>
 <li class="msgbooktype">enter Booktype URL</li>
 <li class="deletebook">Delete book</li>
</ul>

</body>
</html>

