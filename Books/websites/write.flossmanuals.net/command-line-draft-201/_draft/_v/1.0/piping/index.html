
<!DOCTYPE HTML>
<html>
 <head>
   

<link type="text/css" href="/site_static/css/booki.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
<script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
<script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
<script type="text/javascript" src="/site_static/js/booki.js"></script>
<script src="/site_static/js/messaging.js" type="text/javascript"></script>   
<script type="text/javascript" src="/site_static/js/general.js"></script>
<link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
<link type="text/css" href="/site_static/css/jquery-ui_overrides.css" rel="Stylesheet" >
<script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

<link rel="SHORTCUT ICON" href="http://write.flossmanuals.net/site_static/images/favicon.ico" type="image/x-icon">
<meta property="og:site_name" content="FLOSS Manuals"/><meta name="description" content="Free Manuals for Freedom"/>

<script type="text/javascript">
  $(function() {
      $.booki.sputnikDispatcherURL = "/_sputnik/";

      $("#dialog-sputnik-error").dialog({
          modal: true,
          autoOpen: false,
          buttons: {
            Ok: function() {
               $(this).dialog('close');
               window.location = '.';
            }
          }
      });
  
      $("FORM.messagefield").messagefield('init', {'view_post': '/messaging/post' });  
  });
</script>


   
 <title>/chapter: Piping / Command Line Draft 2.0.1</title>
 <link type="text/css" href="/site_static/css/draft.css" rel="Stylesheet" />

 <link rel="alternate" type="application/rss+xml" title="RSS feed for Command Line Draft 2.0.1" href="/feeds/rss/book/command-line-draft-201/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for Command Line Draft 2.0.1" href="/feeds/atom/book/command-line-draft-201/" /> 

 <link rel="alternate" type="application/rss+xml" title="RSS feed for chapter PIPING" href="/feeds/rss/chapter/command-line-draft-201/command-line-draft-201/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for chapter PIPING" href="/feeds/atom/chapter/command-line-draft-201/command-line-draft-201/" /> 
 
 <script type="text/javascript" src="/site_static/js/draft.js"></script>


   <link type="text/css" href="/static/css/_user.css" rel="Stylesheet" >
 </head>
<body>

<div class="topbar"> 
  <div class="logotext"><a href="http://write.flossmanuals.net/">FLOSS Manuals</a> </div>

  <div class="meta-bar">
    
    <ul>
      <li>
        <a href="/accounts/signin/?redirect=/command-line-draft-201/_draft/_v/1.0/piping/">Sign In / Create Account</a>
      </li>
    </ul>
    
    <div style="padding-top: 10px; padding-right: 15px;">
      <br/>
      

<script>
  $(function() {
    var $frm = $("FORM[name=changelang]");
	
    $("A[href=#]", $frm).click(function() {
        var lang = $(this).attr("class").substr(4);
	
        $("INPUT[name=language]", $frm).val(lang);
        $frm.submit();
	
        return false;
    });
  });
 </script>

<form name="changelang" method="POST" action="/accounts/i18n/setlang/?language=en-us">
  <input type="hidden" name="language" value="en-us">
  
    &nbsp;English&nbsp;|
  
  
  
    &nbsp;<a class="langes" href="#">Español</a>&nbsp;|
  

  
    &nbsp;<a class="langfr" href="#">Français</a>&nbsp;|
  
	
  
    &nbsp;<a class="langit" href="#">Italiano</a>&nbsp;|
  
	
  
    &nbsp;<a class="langpt" href="#">Português</a>&nbsp;|
  
	
  
    &nbsp;<a class="langru" href="#">Русский</a>&nbsp;|
  
	
  
    &nbsp;<a class="langsq" href="#">Shqip</a>
  	
</form>

    </div>
    
    
  </div><!-- End of .meta-bar -->
</div><!-- End top bar -->

<div class="menubar shadow">
  
  
  <div class="navbox">
    <ul>
      <li><a href="/list-books/">Books</a></li>
      <li><a href="/list-groups/">Groups</a></li>
      <li><a href="/list-people/">People</a></li>
    </ul>      
  </div><!-- End of .navbox -->       
</div>

<div class="content-container">
  <div class="content shadow">
    <!-- Content box and the drop shadow-->
    

<h2>Command Line Draft 2.0.1</h2>
<div class="padded">
 <div id="bookmenu" style="background: url(/site_static/images/draft_bg.png) repeat !important;"> 
  <ul>
   
    
      <li><b>INTRODUCTION</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/introduction/">INTRODUCTION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/about-this-manual/">ABOUT THIS  MANUAL</a></li>
    
   
    
      <li><b>BASICS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/getting-started/">GETTING STARTED</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/beginning-syntax/">BEGINNING SYNTAX</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/moving-around/">MOVING AROUND</a></li>
    
   
    
      <li><b>COMMANDS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/basic-commands/">BASIC COMMANDS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/standard-files/">STANDARD FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/cut-down-on-typing/">CUT DOWN ON TYPING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/superusers/">SUPERUSERS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/redirection/">REDIRECTION</a></li>
    
   
    
      <li><b>ADVANCED-ISH</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/multiple-files/">MULTIPLE FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/searching-for-files/">SEARCHING FOR FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/piping/">PIPING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/processes/">PROCESSES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/file-structure/">FILE STRUCTURE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/command-history/">COMMAND HISTORY</a></li>
    
   
    
      <li><b>ADVANCED</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/permissions/">PERMISSIONS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/interactive-editing/">INTERACTIVE EDITING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/checking-exit/">CHECKING EXIT</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/sub-commands/">SUB COMMANDS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/moving-again/">MOVING AGAIN</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/customisation/">CUSTOMISATION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/parameter-substitution/">PARAMETER SUBSTITUTION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gnuscreen/">GNUSCREEN</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/ssh/">SSH</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/installing-software/">INSTALLING SOFTWARE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/making-your-own-interpreter/">MAKING YOUR OWN INTERPRETER</a></li>
    
   
    
      <li><b>TEXT EDITORS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/text-editors/">TEXT EDITORS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/nano/">NANO</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/vim/">VIM</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/emacs/">EMACS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/kedit/">KEDIT</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gedit/">GEDIT</a></li>
    
   
    
      <li><b>SCRIPTING</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/scripting/">SCRIPTING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/maintaining-scripts/">MAINTAINING SCRIPTS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/other-languages/">OTHER LANGUAGES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/sed/">SED</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/awk/">AWK</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/regular-expressions/">REGULAR EXPRESSIONS</a></li>
    
   
    
      <li><b>SCRIPTING LANGUAGES</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/perl/">PERL</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/python/">PYTHON</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/ruby/">RUBY</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gnu-octave/">GNU OCTAVE</a></li>
    
   
    
      <li><b>APPENDICES</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/glossary/">GLOSSARY</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/command-quickie/">COMMAND QUICKIE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/outline/">OUTLINE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/credits/">CREDITS</a></li>
    
   
  </ul>
 </div>
 <div id="bookcontent"   style="background: url(/site_static/images/draft_bg.png) repeat !important;">
   

  <html dir="LTR"><head><title>CommandLineIntro: Piping</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body>
<h1>Piping hot commands
</h1>
<p>Pipes let programs work together by connecting the output from one to be the input for another. The term "output" has a precise meaning here:  it is what the program writes to the standard output, via C program statements such as printf or the equivalent, and normally it appears on the terminal screen. And "input" is the standard input, usually coming from the keyboard. Pipes are built using a vertical bar ("|") as the pipe symbol.
</p>
<p>Say you help your eccentric Aunt Hortense manage her private book collection. You have a file named <em>books</em> containing a list of her holdings, one per line, in the format "author:title", something like this:
</p>
<pre>$ <strong>cat books</strong>
Carroll, Lewis:Through the Looking-Glass
Shakespeare, William:Hamlet
Bartlett, John:Familiar Quotations
Mill, John Stuart:On Nature
London, Jack:John Barleycorn
Bunyan, John:Pilgrim's Progress, The
Defoe, Daniel:Robinson Crusoe
Mill, John Stuart:System of Logic, A
Milton, John:Paradise Lost
Johnson, Samuel:Lives of the Poets
Shakespeare, William:Julius Caesar
Mill, John Stuart:On Liberty
Bunyan, John:Saved by Grace
</pre>
<p>This is somewhat untidy, as they are in no particular order. But we can use the <code>sort</code> command to straighten that out:
</p>
<pre>$ <strong>sort books</strong>
Bartlett, John:Familiar Quotations
Bunyan, John:Pilgrim's Progress, The
Bunyan, John:Saved by Grace
Carroll, Lewis:Through the Looking-Glass
Defoe, Daniel:Robinson Crusoe
Johnson, Samuel:Lives of the Poets
London, Jack:John Barleycorn
Mill, John Stuart:On Liberty
Mill, John Stuart:On Nature
Mill, John Stuart:System of Logic, A
Milton, John:Paradise Lost
Shakespeare, William:Hamlet
Shakespeare, William:Julius Caesar
</pre>
<p>Ah, now you have a list nicely sorted by author. How about getting a list just of authors, without titles? You can do that with the <code>cut</code> command:
</p>
<pre>$ <strong>cut -d: -f1 books</strong>
Carroll, Lewis
Shakespeare, William
Bartlett, John
Mill, John Stuart
London, Jack
Bunyan, John
Defoe, Daniel
Mill, John Stuart
Milton, John
Johnson, Samuel
Shakespeare, William
Mill, John Stuart
Bunyan, John
</pre>
<p>A little explanation here. The <code>-d</code> option chose a colon as the delimiter (separator). This tells <code>cut</code> to break up each line wherever a delimiter appears, and each separate part of the line is called a field. In our format, the author's name appears as the first field, so we have put a 1 with the <code>-f</code> option to tell <code>cut</code> that we want to see just that field.
</p>
<p>But you'll notice the list is unsorted again. Pipelines to the rescue!
</p>
<pre>$ <strong>sort books | cut -d: -f1</strong>
Bartlett, John
Bunyan, John
Bunyan, John
Carroll, Lewis
Defoe, Daniel
Johnson, Samuel
London, Jack
Mill, John Stuart
Mill, John Stuart
Mill, John Stuart
Milton, John
Shakespeare, William
Shakespeare, William
</pre>
<p>Voila! You've taken the alphabetized list, which is the output of the <code>sort</code> command, and fed it as input to the <code>cut</code> command. Don't give the <code>cut</code> command a filename to use, because you want it to operate on the text that's piped out of the <code>sort</code> command.
</p>
<p>Pipes are just that simple--text flows down the pipe from one command to the next.
  <br></p>
<p>How about if you wanted a sorted list of titles instead? Since the title is the second field, let's try using <code>-f2</code> with the <code>cut</code> command instead of <code>-f1</code>:
</p>
<pre>$ <strong>sort books | cut -d: -f2</strong>
Familiar Quotations
Pilgrim's Progress, The
Saved by Grace
Through the Looking-Glass
Robinson Crusoe
Lives of the Poets
John Barleycorn
On Liberty
On Nature
System of Logic, A
Paradise Lost
Hamlet
Julius Caesar
</pre>
<p>Oops. What happened? When looking at a pipeline, you need to go left-to-right. In this case, we sorted the file first before extracting the titles. So it dutifully sorted the lines starting with the author at the beginning of each line. To get the <em>titles</em> in the proper order, you need to do the sort <em>after</em> extracting them:
</p>
<pre>$ <strong>cut -d: -f2 books | sort</strong>
Familiar Quotations
Hamlet
John Barleycorn
Julius Caesar
Lives of the Poets
On Liberty
On Nature
Paradise Lost
Pilgrim's Progress, The
Robinson Crusoe
Saved by Grace
System of Logic, A
Through the Looking-Glass
</pre>
<p>Much better. Now this is all very nice, but you may be thinking you could have done these things with a spreadsheet. For simpler tasks, this is probably true. But suppose that Aunt Hortense is in the habit of asking odd questions about her collection. For example, she wants to know how many books she has from each author named John. A spreadsheet or other graphical program may have difficulty handling a request that wasn't anticipated by the program's authors. But the shell offers us many small, simple commands that can be combined in unforeseen ways to accomplish a complex task.
</p>
<p>To find a particular string in a line of text, use the <code>grep</code> command. Now remember that when you combine commands, they need to go in the proper order. You can't run <code>grep</code> against the file first, because it will match the title "John Barleycorn" in addition to authors named John. So add it to the end of the pipeline:
</p>
<pre>$ <strong>cut -d: -f1 books | sort | grep "John"</strong>
Bartlett, John
Bunyan, John
Bunyan, John
Johnson, Samuel
Mill, John Stuart
Mill, John Stuart
Mill, John Stuart
Milton, John
</pre>
<p>This gets us close, but you don't want to get "Samuel Johnson" on the list and make Aunt Hortense angry. Often when working with <code>grep</code> you will need to refine the matching text to get exactly what you need. <code>grep</code> happens to offer a <code>-w</code> option that will let it match "John" only when "John" is a complete word, not when it's part of "Johnson". But we'll solve this particular dilemma by adding a comma and space on the front of the string to match, so it will match only when John is a first name:
</p>
<pre>$ <strong>cut -d: -f1 books | sort | grep ", John"</strong>
Bartlett, John
Bunyan, John
Bunyan, John
Mill, John Stuart
Mill, John Stuart
Mill, John Stuart
Milton, John
</pre>
<p>Ah, that's better. Now you just need to total up the number of books for each author. A little command called <code>uniq</code> will work nicely. It removes duplicate lines (duplicates must be on consecutive lines, so be sure your text is sorted first), and when used with the <code>-c</code> option also provides a count:
</p>
<pre>$ <strong>cut -d: -f1 books | sort | grep ", John" | uniq -c</strong>
      1 Bartlett, John
      2 Bunyan, John
      3 Mill, John Stuart
      1 Milton, John
</pre>And there you are! A nicely sorted list of Johns and the number of books from each. For our example set this is a simple job, one you could even do with pencil and paper. But this very same pipeline can be used to process far more data--it won't blink even if Aunt Hortense has hundreds of thousands of books stored in the barn.
<p>System administrators often use pipelines like these to deal with log files generated by web and mail servers. Such files can grow to tens or hundreds of megabytes in size, and a command pipeline can be a quick way to generate summary statistics without trying to read through the entire log.
</p>
<p>A nice thing about building pipelines is that you can do it one command at a time, seeing exactly what effect each one has on the output. This can help you discover when you might need to tweak options or rearrange the order of commands. For instance, to put the authors in ranking order, you can just add a <code>sort -nr</code> to the previous pipeline:
  <br></p>
<pre>$<strong> cut -d: -f1 books | sort | grep ", John" | uniq -c | sort -nr</strong>
      3 Mill, John Stuart
      2 Bunyan, John
      1 Milton, John
      1 Bartlett, John
</pre>
<p>Experiment!
</p>
</body></html>
   
  </div>
 </div>


  </div>
</div>
<!-- End of content -->



<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
<div id="dialog-sputnik-error" title="Can't communicate with booktype">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    There has been error in communication with Booktype server.
    Not sure right now where is the problem.
  </p>
  <p>
    You should refresh this page.
  </p>
</div>


<ul class="strings template">
 <li class="ok">OK</li>
 <li class="back">Back</li>
 <li class="create">Create</li>
 <li class="cancel">Cancel</li>
 <li class="next">Next</li>
 <li class="import">Import</li>
 <li class="savechanges">Save changes</li>
 <li class="errorcreategroup">Couldn't create a group!</li>
 <li class="msgepub">enter epub URL</li>
 <li class="msgarchive">enter Archive.org ID</li>
 <li class="msgwiki">enter Wikibooks URL</li>
 <li class="msgbooktype">enter Booktype URL</li>
 <li class="deletebook">Delete book</li>
</ul>

</body>
</html>

