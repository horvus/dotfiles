
<!DOCTYPE HTML>
<html>
 <head>
   

<link type="text/css" href="/site_static/css/booki.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/base/jquery.ui.all.css" rel="Stylesheet" >
<link type="text/css" href="/site_static/js/jquery/themes/smoothness/jquery.ui.all.css" rel="Stylesheet" >
<script type="text/javascript" src="/site_static/js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript" src="/site_static/js/jquery/ui/jquery-ui-1.8.10.custom.js"></script>
<script type="text/javascript" src="/site_static/js/jquery.json-1.3.js"></script>
<script type="text/javascript" src="/site_static/js/booki.js"></script>
<script src="/site_static/js/messaging.js" type="text/javascript"></script>   
<script type="text/javascript" src="/site_static/js/general.js"></script>
<link href="/site_static/css/jquery.bubblepopup.v2.3.1.css" rel="stylesheet" type="text/css" />
<link type="text/css" href="/site_static/css/jquery-ui_overrides.css" rel="Stylesheet" >
<script src="/site_static/js/jquery.bubblepopup.v2.3.1.min.js" type="text/javascript"></script>

<link rel="SHORTCUT ICON" href="http://write.flossmanuals.net/site_static/images/favicon.ico" type="image/x-icon">
<meta property="og:site_name" content="FLOSS Manuals"/><meta name="description" content="Free Manuals for Freedom"/>

<script type="text/javascript">
  $(function() {
      $.booki.sputnikDispatcherURL = "/_sputnik/";

      $("#dialog-sputnik-error").dialog({
          modal: true,
          autoOpen: false,
          buttons: {
            Ok: function() {
               $(this).dialog('close');
               window.location = '.';
            }
          }
      });
  
      $("FORM.messagefield").messagefield('init', {'view_post': '/messaging/post' });  
  });
</script>


   
 <title>/chapter: Checking-Exit / Command Line Draft 2.0.1</title>
 <link type="text/css" href="/site_static/css/draft.css" rel="Stylesheet" />

 <link rel="alternate" type="application/rss+xml" title="RSS feed for Command Line Draft 2.0.1" href="/feeds/rss/book/command-line-draft-201/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for Command Line Draft 2.0.1" href="/feeds/atom/book/command-line-draft-201/" /> 

 <link rel="alternate" type="application/rss+xml" title="RSS feed for chapter CHECKING EXIT" href="/feeds/rss/chapter/command-line-draft-201/command-line-draft-201/" /> 
 <link rel="alternate" type="application/atom+xml" title="Atom feed for chapter CHECKING EXIT" href="/feeds/atom/chapter/command-line-draft-201/command-line-draft-201/" /> 
 
 <script type="text/javascript" src="/site_static/js/draft.js"></script>


   <link type="text/css" href="/static/css/_user.css" rel="Stylesheet" >
 </head>
<body>

<div class="topbar"> 
  <div class="logotext"><a href="http://write.flossmanuals.net/">FLOSS Manuals</a> </div>

  <div class="meta-bar">
    
    <ul>
      <li>
        <a href="/accounts/signin/?redirect=/command-line-draft-201/_draft/_v/1.0/checking-exit/">Sign In / Create Account</a>
      </li>
    </ul>
    
    <div style="padding-top: 10px; padding-right: 15px;">
      <br/>
      

<script>
  $(function() {
    var $frm = $("FORM[name=changelang]");
	
    $("A[href=#]", $frm).click(function() {
        var lang = $(this).attr("class").substr(4);
	
        $("INPUT[name=language]", $frm).val(lang);
        $frm.submit();
	
        return false;
    });
  });
 </script>

<form name="changelang" method="POST" action="/accounts/i18n/setlang/?language=en-us">
  <input type="hidden" name="language" value="en-us">
  
    &nbsp;English&nbsp;|
  
  
  
    &nbsp;<a class="langes" href="#">Español</a>&nbsp;|
  

  
    &nbsp;<a class="langfr" href="#">Français</a>&nbsp;|
  
	
  
    &nbsp;<a class="langit" href="#">Italiano</a>&nbsp;|
  
	
  
    &nbsp;<a class="langpt" href="#">Português</a>&nbsp;|
  
	
  
    &nbsp;<a class="langru" href="#">Русский</a>&nbsp;|
  
	
  
    &nbsp;<a class="langsq" href="#">Shqip</a>
  	
</form>

    </div>
    
    
  </div><!-- End of .meta-bar -->
</div><!-- End top bar -->

<div class="menubar shadow">
  
  
  <div class="navbox">
    <ul>
      <li><a href="/list-books/">Books</a></li>
      <li><a href="/list-groups/">Groups</a></li>
      <li><a href="/list-people/">People</a></li>
    </ul>      
  </div><!-- End of .navbox -->       
</div>

<div class="content-container">
  <div class="content shadow">
    <!-- Content box and the drop shadow-->
    

<h2>Command Line Draft 2.0.1</h2>
<div class="padded">
 <div id="bookmenu" style="background: url(/site_static/images/draft_bg.png) repeat !important;"> 
  <ul>
   
    
      <li><b>INTRODUCTION</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/introduction/">INTRODUCTION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/about-this-manual/">ABOUT THIS  MANUAL</a></li>
    
   
    
      <li><b>BASICS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/getting-started/">GETTING STARTED</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/beginning-syntax/">BEGINNING SYNTAX</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/moving-around/">MOVING AROUND</a></li>
    
   
    
      <li><b>COMMANDS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/basic-commands/">BASIC COMMANDS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/standard-files/">STANDARD FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/cut-down-on-typing/">CUT DOWN ON TYPING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/superusers/">SUPERUSERS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/redirection/">REDIRECTION</a></li>
    
   
    
      <li><b>ADVANCED-ISH</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/multiple-files/">MULTIPLE FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/searching-for-files/">SEARCHING FOR FILES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/piping/">PIPING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/processes/">PROCESSES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/file-structure/">FILE STRUCTURE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/command-history/">COMMAND HISTORY</a></li>
    
   
    
      <li><b>ADVANCED</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/permissions/">PERMISSIONS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/interactive-editing/">INTERACTIVE EDITING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/checking-exit/">CHECKING EXIT</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/sub-commands/">SUB COMMANDS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/moving-again/">MOVING AGAIN</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/customisation/">CUSTOMISATION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/parameter-substitution/">PARAMETER SUBSTITUTION</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gnuscreen/">GNUSCREEN</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/ssh/">SSH</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/installing-software/">INSTALLING SOFTWARE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/making-your-own-interpreter/">MAKING YOUR OWN INTERPRETER</a></li>
    
   
    
      <li><b>TEXT EDITORS</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/text-editors/">TEXT EDITORS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/nano/">NANO</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/vim/">VIM</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/emacs/">EMACS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/kedit/">KEDIT</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gedit/">GEDIT</a></li>
    
   
    
      <li><b>SCRIPTING</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/scripting/">SCRIPTING</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/maintaining-scripts/">MAINTAINING SCRIPTS</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/other-languages/">OTHER LANGUAGES</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/sed/">SED</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/awk/">AWK</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/regular-expressions/">REGULAR EXPRESSIONS</a></li>
    
   
    
      <li><b>SCRIPTING LANGUAGES</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/perl/">PERL</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/python/">PYTHON</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/ruby/">RUBY</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/gnu-octave/">GNU OCTAVE</a></li>
    
   
    
      <li><b>APPENDICES</b></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/glossary/">GLOSSARY</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/command-quickie/">COMMAND QUICKIE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/outline/">OUTLINE</a></li>
    
   
    
      <li><a href="/command-line-draft-201/_draft/_v/1.0/credits/">CREDITS</a></li>
    
   
  </ul>
 </div>
 <div id="bookcontent"   style="background: url(/site_static/images/draft_bg.png) repeat !important;">
   

  <html dir="LTR"><head><title>CommandLineIntro: CheckingExit</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body>
<h1> Exit status
</h1>
<ol><ol></ol></ol><p>When you type commands, you can usually tell whether they worked or not. Commands that are unable to do what you asked usually print an error message. This is sufficient if you are typing in each command by hand and looking at the output, but sometimes (for example, if you are writing a script) you want to have your commands react differently when a command fails.
</p>
<p>To facilitate this, when a command finishes it returns an <em>exit status</em>. The exit status is not normally displayed; instead it is placed in a variable (a named memory slot) named "<strong>$?</strong>". The exit status is a number between 0 and 255 (inclusive); zero means success, and any other value means a failure.
</p>
<p>One way to see the exit status of a command is to use the <code>echo</code> command to display it:
  <br></p>
<pre>$<strong> echo "this works fine"</strong>
this works fine
$<strong> echo $?</strong>
0
$<strong> hhhhhh</strong>
bash: hhhhhh: command not found
$<strong> echo $?</strong>
127
</pre>
<p>Now we'll look at various ways to handle errors.
  <br></p>
<h2>if/then
</h2>
<p>Handling an error is an example of something you do conditionally: <em>if</em> something happens, <em>then</em> you want to take action.   The shell provides a compound command--a command that runs other commands--called <code>if</code>.  The most basic form is:
</p>
<pre><strong>if</strong>
<strong><em>  &lt;command&gt;</em></strong>
<strong>then</strong>
<strong><em>  &lt;commands-if-successful&gt;</em></strong>
<strong>fi</strong></pre>
<p>We will start with a basic example, then improve it to make it more useful.  After we type <code>if</code> and press the <strong>Enter</strong> key, the shell knows we're in the middle of a compound command, so it displays a different prompt (<strong>&gt;</strong>) to remind us of that.
</p>
<pre class="SCREEN">$ <strong>if</strong>
&gt; <strong>man ls</strong>
&gt; <strong>then</strong>
&gt; <strong>echo "You now know more about ls"</strong>
&gt; <strong>fi</strong>
<em>The manual page for ls scrolls by</em>
You now know more about ls
</pre>
<p>Running this command brings up the manual page for <code>ls</code>.  Upon quitting with the <strong>q</strong> key, the <code>man</code> command exits successfully and the <code>echo</code> command runs.
</p>
<h3><strong>Handling command failure </strong>
</h3>
<p>
</p>
<p>Adding an <code>else</code> clause allows us to specify what to run on failure:
</p>
<pre><strong>if</strong>
<em>  <strong>&lt;command&gt;</strong></em>
<strong>then</strong>
<em>  <strong>&lt;commands-if-successful&gt;</strong></em>
<strong>else</strong>
<em>  <strong>&lt;commands-if-failed&gt;</strong></em>
<strong>fi</strong></pre>
<p>Let's run <code>apropos</code> if the <code>man</code> command fails.
</p>
<pre class="SCREEN">$<strong> if</strong>
&gt;<strong> man draw</strong>
&gt;<strong> then</strong>
&gt;<strong> echo "You now know more about draw"</strong>
&gt;<strong> else</strong>
&gt;<strong> apropos draw</strong>
&gt;<strong> fi</strong>
<em>...
list of results for apropos draw
...
</em>
</pre>
<p>This time the <code>man</code> command failed because there is no <code>draw</code> command, activating the else clause.
</p>
<h2>&amp;&amp; and ||
</h2>
<p>The if-then construct is very useful, but rather verbose for chaining together dependent commands.  The "<em>&amp;&amp;</em>" <em>(and)</em> and "<em>||</em>" <em>(or)</em> operators provide a more compact format.
</p>
<pre><strong>command1 &amp;&amp; command2 [&amp;&amp; command3]...</strong></pre>
<p>The &amp;&amp; operator links two commands together.  The second command will run only if the first has an exit status of zero, that is, if the first command was successful.  Multiple instances of the &amp;&amp; operator can be used on the same line.
</p>
<pre>$<strong> mkdir mylogs &amp;&amp; cd mylogs &amp;&amp; touch mail.log &amp;&amp; chmod 0660 mail.log</strong></pre>
<p>Here is an example of multiple commands, each of which assume the prior one has run successfully.  If we were to use the if-then construct to do this, we would have ended up with an unwieldy mass of ifs and thens.
</p>
<p>Note that the &amp;&amp; operator <em>short circuits</em>, that is, if one command fails, no subsequent command is run.  We take advantage of this property to prevent unwanted effects (like creating <em>mail.log</em> in the wrong directory in the above example).
</p>
<p>If <em>&amp;&amp;</em> is the equivalent of <code>then</code>, the <em>|| operator</em> is the equivalent of <code>else</code>.  It provides us a mechanism to specify what command to run if the first fails.
</p>
<pre><strong>command1 || command2 || command3 || ...</strong></pre>
<p>Each command in the chain will be run only if the previous command did not succeed (that is, had a nonzero exit status).
</p>
<pre>$<strong> cd Desktop || mkdir Desktop || echo "Desktop directory not found and could not be created"</strong></pre>
<p>In this example we try to enter the <em>Desktop</em> directory, failing which we create it, failing which we inform the user with an error message.
</p>
<p>With this knowledge we can write an efficient and compact <code>helpme</code> function.  Our previous examples have shown the two operators used in isolation, but they can be mixed as well.
</p>
<pre>$<strong> function helpme() {
  man $1 &amp;&amp; echo "you now know more about $1" || apropos $1
}</strong>
</pre>
<p>As you probably suspect, the "you now know..." echo is not exactly the most useful command.  (It might not even be accurate, perhaps the <code>man</code> page introduced so many options and confused the poor user).  We heartily confess we threw it in just to match the original if-then syntax.  Now that we know about the <em>|| operator</em>, we can simplify the function to:
</p>
<pre>$<strong> function helpme() {
  man $1 || apropos $1
}</strong>
</pre>
<h2>What does an exit status mean?
</h2>
<p>Up to now, we considered only the difference between zero and non-zero exit statuses.  We know that zero means success, and non-zero means a failure.  But what kind of failure?  Some exit values may be used for user-specified exit parameters, so that their meaning may vary for one command to another.  However, some widely accepted meanings for particular values do exist.
</p>
<p>For example, if you invoke an inexistent command (e.g. by wrongly typing an existing one or by omitting its correct path), you should expect to receive the standard notification of "command not found" which is generally associated with the exit status 127.  We encountered this value at the very beginning of this chapter:
  <br></p>
<pre>$<strong> hhhhhh</strong>
bash: hhhhhh: command not found
$<strong> echo $?</strong>
127</pre>
<p>Another exit status to which attention should be drawn is "permission denied", usually the code 126.  When you encounter this value, it may be worth enhancing the level of attention.  The command you are trying to execute requires permissions you do not have.  There are some frequent cases.
</p>
<p>First, you attempted to execute as a normal user a command which requires root privileges.  In this case, if you know what are you doing, you should log in as root and then invoke the command again.  However, if you are plenty of doubts about that command, it would probably be a good idea to spend some time documenting yourself about.  If that command requires root privileges, it is likely to be potentially harmful if not<em> </em><span id="main"><span id="search"><em></em> used correctly</span></span>.
</p>
<p>Second, you may be trying to run a software which has been installed with the wrong privileges.  For instance, you may be collaborating with other people in developing an application which is hosted in the home path of another user and that user may have missed to allow you to run the executable.  The <code>chown</code> and <code>chmod</code> commands can help.
</p>
<p>There is even the possibility you are trying to obtain information about your system without modifying the system status, so you may think this should be possible without the need to be root.  It is often possible, but not always.  For example, you may check the status of the <code>ssh</code> and <code>at</code> services: the first one is normally readable while the second one may not:
  <br></p>
<pre>$<strong> /etc/init.d/sshd status</strong>
sshd (pid 1234) is running...
<strong>
</strong>$<strong> /etc/init.d/atd status</strong>
bash: /etc/init.d/atd: Permission denied
$<strong> echo $?</strong>
126</pre>
<p>It may happen that an invoked command takes a long time to complete.  If that command is needed to generate or modify information which is required by your subsequent commands, then you should check that the time-demanding command you've started has not been unexpectedly terminated its execution.  This is different from checking that the command correctly terminated (exit status 0).  That command may encounter an error condition and decide to terminate with a non-zero exit code.  However it is very different the case in which the command cannot choose its exit status because it cannot terminate at all.  Whether an infinite loop inside the command requires an extern intervention or a premature extern intervention overrides the correctly running command,  an INT signal (which is a user interrupt) may be sent to the command by hitting <strong>ctrl + c</strong> or killing the command via:
  <br></p>
<pre>$<strong> kill -int <em>pid-of-the-command</em></strong></pre>
<p>
</p>
<p>Such kind of termination may alter the expected output of the interrupted command and break some subsequent manipulation of that output.  When an INT signal terminates a command, a 130 exit status is returned.  For instance, consider the <code>yes</code> command which requires a <strong>ctrl + c</strong> to terminate:
  <br></p>
<pre>$ <strong>yes</strong>
<em></em>y
y
y
...
# press ctrl+c <strong>
$ echo $?
</strong>130
</pre>
<p>That covers the concept of exit status and using it to control the flow of your command and scripts. We hope you leave this chapter with an exit status of zero!
</p>
</body></html>
   
  </div>
 </div>


  </div>
</div>
<!-- End of content -->



<!-- sputnik error page -->
<div id="dialog-sputnik-qrac" style="display: none"></div>
<div id="dialog-sputnik-error" title="Can't communicate with booktype">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    There has been error in communication with Booktype server.
    Not sure right now where is the problem.
  </p>
  <p>
    You should refresh this page.
  </p>
</div>


<ul class="strings template">
 <li class="ok">OK</li>
 <li class="back">Back</li>
 <li class="create">Create</li>
 <li class="cancel">Cancel</li>
 <li class="next">Next</li>
 <li class="import">Import</li>
 <li class="savechanges">Save changes</li>
 <li class="errorcreategroup">Couldn't create a group!</li>
 <li class="msgepub">enter epub URL</li>
 <li class="msgarchive">enter Archive.org ID</li>
 <li class="msgwiki">enter Wikibooks URL</li>
 <li class="msgbooktype">enter Booktype URL</li>
 <li class="deletebook">Delete book</li>
</ul>

</body>
</html>

